
"""
div class="mw-page-container"
div class="mw-page-container-inner"
div class="vector-sitenotice-container"
div class="vector-column-start"
div class="mw-content-container"
main content class="mw-body"
div id="bodyContent" class="vector-body ve-init-mw-desktopArticleTarget-targetContainer"
div id="mw-content-text" class="mw-body-content"
div class="mw-content-ltr mw-parser-output"
<h3><span id=".EC.83.81.EB.B0.98.EA.B8.B0"></span><span class="mw-headline" id="상반기">상반기</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/w/index.php?title=2016%EB%85%84_%EB%8C%80%ED%95%9C%EB%AF%BC%EA%B5%AD%EC%9D%98_%EC%98%81%ED%99%94_%EB%AA%A9%EB%A1%9D&amp;action=edit&amp;section=2" title="부분 편집: 상반기"><span>편집</span></a><span class="mw-editsection-bracket">]</span></span></h3>
<table class="sortable wikitable jquery-tablesorter">
<caption>
</caption>
<thead><tr style="background:#b0e0e6; text-align:center;">
<th colspan="2" class="headerSort" tabindex="0" role="columnheader button" title="오름차순 정렬">개봉일
</th>
<th class="headerSort" tabindex="0" role="columnheader button" title="오름차순 정렬">제목</th>
<th class="headerSort" tabindex="0" role="columnheader button" title="오름차순 정렬">제작/배급
</th>
<th class="headerSort" tabindex="0" role="columnheader button" title="오름차순 정렬">출연/제작진</th>
<th class="headerSort" tabindex="0" role="columnheader button" title="오름차순 정렬">장르
</th></tr></thead><tbody>
<tr>
<th rowspan="9" style="text-align:center; background:#ffa07a; textcolor:#000;">1<br>월
</th>
<td rowspan="2" style="text-align:center; background:#ffdacc;">7일</td>
<td>〈<a href="/wiki/%EC%9E%A1%EC%95%84%EC%95%BC_%EC%82%B0%EB%8B%A4" title="잡아야 산다">잡아야 산다</a>〉</td>
<td></td>
<td>감독 <a href="/w/index.php?title=%EC%98%A4%EC%9D%B8%EC%B2%9C&amp;action=edit&amp;redlink=1" class="new" title="오인천 (없는 문서)">오인천</a></td>
<td>코미디, 액션
</td></tr>
<tr>
<td>〈<a href="/wiki/%EB%82%98%EB%A5%BC_%EC%9E%8A%EC%A7%80_%EB%A7%90%EC%95%84%EC%9A%94" title="나를 잊지 말아요">나를 잊지 말아요</a>〉</td>
<td></td>
<td>감독 <a href="/wiki/%EC%9D%B4%EC%9C%A4%EC%A0%95" class="mw-disambig" title="이윤정">이윤정</a></td>
<td>멜로/로맨스
</td></tr>
</tbody><tfoot></tfoot></table>

<h3><span id=".ED.95.98.EB.B0.98.EA.B8.B0"></span><span class="mw-headline" id="하반기">하반기</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/w/index.php?title=2016%EB%85%84_%EB%8C%80%ED%95%9C%EB%AF%BC%EA%B5%AD%EC%9D%98_%EC%98%81%ED%99%94_%EB%AA%A9%EB%A1%9D&amp;action=edit&amp;section=3" title="부분 편집: 하반기"><span>편집</span></a><span class="mw-editsection-bracket">]</span></span></h3>

<table class="sortable wikitable jquery-tablesorter">
<caption>
</caption>
<thead><tr style="background:#b0e0e6; text-align:center;">
<th colspan="2" class="headerSort" tabindex="0" role="columnheader button" title="오름차순 정렬">개봉일
</th>
<th class="headerSort" tabindex="0" role="columnheader button" title="오름차순 정렬">제목</th>
<th class="headerSort" tabindex="0" role="columnheader button" title="오름차순 정렬">제작/배급
</th>
<th class="headerSort" tabindex="0" role="columnheader button" title="오름차순 정렬">출연/제작진</th>
<th class="headerSort" tabindex="0" role="columnheader button" title="오름차순 정렬">장르
</th></tr></thead><tbody>
<tr>
<th rowspan="2" style="text-align:center; background:#ffa07a; textcolor:#000;">7<br>월
</th>
<td rowspan="1" style="text-align:center; background:#ffdacc;">6일</td>
<td>〈<a href="/wiki/%EB%B4%89%EC%9D%B4_%EA%B9%80%EC%84%A0%EB%8B%AC" class="mw-disambig" title="봉이 김선달">봉이 김선달</a>〉</td>
<td></td>
<td>감독 <a href="/w/index.php?title=%EB%B0%95%EB%8C%80%EB%AF%BC&amp;action=edit&amp;redlink=1" class="new" title="박대민 (없는 문서)">박대민</a></td>
<td>사극
</td></tr>
<tr>
<th rowspan="2" style="text-align:center; background:#98fb98; textcolor:#000;">12<br>월
</th>
<td rowspan="1" style="text-align:center; background:#e0f9e0;">14일</td>
<td>〈<a href="/wiki/%EB%AA%A9%EC%88%A8_%EA%B1%B4_%EC%97%B0%EC%95%A0" title="목숨 건 연애">목숨 건 연애</a>〉</td>
<td></td>
<td>감독 <a href="/wiki/%EC%86%A1%EB%AF%BC%EA%B7%9C" class="mw-disambig" title="송민규">송민규</a></td>
<td>멜로, 코미디
</td></tr>
<tr>
<td rowspan="1" style="text-align:center; background:#e0f9e0;">21일</td>
<td>〈<a href="/wiki/%EB%A7%88%EC%8A%A4%ED%84%B0" class="mw-disambig" title="마스터">마스터</a>〉</td>
<td></td>
<td>감독 <a href="/wiki/%EC%A1%B0%EC%9D%98%EC%84%9D" title="조의석">조의석</a></td>
<td>액션, 범죄
</td></tr></tbody><tfoot></tfoot></table>
"""
import re
import logging
from selenium import webdriver
from selenium.webdriver.chrome.options import Options
from selenium.webdriver.common.by import By
from selenium.webdriver.support.ui import WebDriverWait
from selenium.webdriver.support import expected_conditions as EC
from selenium.common.exceptions import TimeoutException

# Chrome 옵션 설정
chrome_options = Options()
chrome_options.add_experimental_option("detach", True)
chrome_options.add_argument("--log-level=3")  # 로그 레벨을 높여 경고 메시지 억제

# WebDriver 설정
driver = webdriver.Chrome(options=chrome_options)

# 연도 및 URL 템플릿 정의
year = 2017
url_template = f"https://ko.wikipedia.org/wiki/{year}년_대한민국의_영화_목록"

# 영화 목록을 저장할 딕셔너리
movies = {}

# 주어진 URL로 접속
driver.get(url_template)

try:
    # 페이지가 로드될 때까지 대기
    WebDriverWait(driver, 10).until(EC.presence_of_element_located((By.CSS_SELECTOR, "div.mw-parser-output")))
    print("Page loaded successfully.")

    # 상반기 영화 목록 추출
    first_half_section = driver.find_element(By.XPATH, "//span[@id='상반기']/parent::h3/following-sibling::table[1]")
    first_half_movies = first_half_section.find_elements(By.XPATH, ".//tbody//tr")
    first_half_list = []
    for movie in first_half_movies:
        cells = movie.find_elements(By.TAG_NAME, 'td')
        if cells:
            title = cells[1].text.strip()
            title = re.sub(r'[〈〉]', '', title)  # 꺾쇠 괄호 제거
            if title:  # 비어있는 제목 제외
                first_half_list.append(title)
    print("First half movies:", first_half_list)

    # 하반기 영화 목록 추출
    second_half_section = driver.find_element(By.XPATH, "//span[@id='하반기']/parent::h3/following-sibling::table[1]")
    second_half_movies = second_half_section.find_elements(By.XPATH, ".//tbody//tr")
    second_half_list = []
    for movie in second_half_movies:
        cells = movie.find_elements(By.TAG_NAME, 'td')
        if cells:
            title = cells[1].text.strip()
            title = re.sub(r'[〈〉]', '', title)  # 꺾쇠 괄호 제거
            if title:  # 비어있는 제목 제외
                second_half_list.append(title)
    print("Second half movies:", second_half_list)

    movies[year] = first_half_list + second_half_list

except TimeoutException:
    print(f"TimeoutException: {year}년 페이지를 로드하는 데 실패했습니다.")

# WebDriver 종료
driver.quit()

# 결과 출력 (연도별 첫 5개의 영화 제목만 출력)
print(f"{year}년 영화 목록:")
for movie in movies[year]:
    print(f"- {movie}")

print("\n연도별 첫 5개의 영화 제목:")
for movie in movies[year][:5]:
    print(f"- {movie}")
